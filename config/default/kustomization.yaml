namespace: capk-system

namePrefix: capk-

commonLabels:
  cluster.x-k8s.io/provider: kubevirt
  cluster.x-k8s.io/v1alpha1: v1alpha1
  cluster.x-k8s.io/v1alpha2: v1alpha1
  cluster.x-k8s.io/v1alpha3: v1alpha1
  cluster.x-k8s.io/v1alpha4: v1alpha1
  cluster.x-k8s.io/v1beta1: v1alpha1

resources:
- namespace.yaml
- ../crd
- ../rbac
- ../manager
- ../webhook
- ../certmanager


  # Provide customizable hook for make targets.
  # Enable webhook.
  # Inject certificate in the webhook definition.
patchesStrategicMerge:
- manager_image_patch.yaml
- manager_pull_policy.yaml
- manager_webhook_patch.yaml
- webhookcainjection_patch.yaml

vars:
- fieldref:
    fieldPath: metadata.namespace
  name: CERTIFICATE_NAMESPACE
  objref:
    group: cert-manager.io
    kind: Certificate
    name: serving-cert
    version: v1
- fieldref: {}
  name: CERTIFICATE_NAME
  objref:
    group: cert-manager.io
    kind: Certificate
    name: serving-cert
    version: v1
- fieldref:
    fieldPath: metadata.namespace
  name: SERVICE_NAMESPACE
  objref:
    kind: Service
    name: webhook-service
    version: v1
- fieldref: {}
  name: SERVICE_NAME
  objref:
    kind: Service
    name: webhook-service
    version: v1

configurations:
- kustomizeconfig.yaml
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
images:
- name: controller
  newName: 127.0.0.1:5000/capk-manager
  newTag: dev
